{"version":3,"sources":["../../src/pages/material/material.module.ts","../../src/pages/material/material.ts"],"names":[],"mappings":"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","file":"27.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { MaterialPage } from './material';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    MaterialPage,\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(MaterialPage),\r\n  ],\r\n})\r\nexport class materialPageModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/material/material.module.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, ModalController, NavParams, AlertController } from 'ionic-angular';\r\nimport { PouchService } from '../../pouch-service/pouch.service';\r\nimport { Material } from '../../models/material';\r\nimport * as XLSX from 'xlsx';\r\nimport * as _ from 'lodash'; // to help loop over files more succinctly\r\nimport * as papa from 'papaparse';\r\nimport { Http } from '@angular/http';\r\n\r\n/**\r\n * Generated class for the materialPage page.\r\n *\r\n * See https://ionicframework.com/docs/components/#navigation for more info on\r\n * Ionic pages and navigation.\r\n */\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-material',\r\n  templateUrl: 'material.html',\r\n})\r\nexport class MaterialPage {\r\n  filteredmaterial: Array<Material> = [];\r\n  public material: Array<Material> = [];\r\n  files: FileList;\r\n  convertFiles;\r\n  show = false;\r\n  showButton = false;\r\n  localStorageItem;\r\n  position;\r\n  public user: any;\r\n  alert = false;\r\n  newMaterials;\r\n  tableCheck = false;\r\n\r\n  constructor(public navCtrl: NavController, private http: Http, public alertCtrl: AlertController, public db: PouchService, public navParams: NavParams, public modalCtrl: ModalController) {\r\n  }\r\n\r\n  ionViewDidLoad() {\r\n    this.localStorageItem = JSON.parse(localStorage.getItem('user'));\r\n    console.log('ionViewDidLoad materialPage');\r\n    this.db.getSupervisor(this.localStorageItem).then(item => {\r\n      this.user = item;\r\n      this.position = item.post;\r\n      if (this.position == 'Manager' || this.position == 'Supervisor' || this.position == 'Admin') {\r\n        this.showButton = true;\r\n      }\r\n    });\r\n    this._loadmaterialcats();\r\n  }\r\n\r\n  /**\r\n   * On display page\r\n   */\r\n  ionViewDidEnter() {\r\n    this.localStorageItem = JSON.parse(localStorage.getItem('user'));\r\n    this.db.getSupervisor(this.localStorageItem).then(item => {\r\n      this.user = item;\r\n      this.position = item.post;\r\n      if (this.position == 'Manager' || this.position == 'Supervisor' || this.position == 'Admin') {\r\n        this.showButton = true;\r\n      }\r\n    });\r\n    this._loadmaterialcats();\r\n  }\r\n\r\n  private _loadmaterialcats(): void {\r\n    this.db.getmaterials()\r\n      .then((material: Array<Material>) => {\r\n        this.filteredmaterial = material;\r\n        this.material = material;\r\n      });\r\n  }\r\n\r\n  back() {\r\n    this.navCtrl.pop();\r\n  }\r\n\r\n  newmaterialcat() {\r\n    let modal = this.modalCtrl.create('AddmaterialPage', { type: 'Add' });\r\n    modal.onDidDismiss((data) => {\r\n      if (data) {\r\n        this._loadmaterialcats();\r\n      }\r\n    });\r\n    modal.present();\r\n  }\r\n\r\n  openmaterialcat(material) {\r\n    let modal = this.modalCtrl.create('AddmaterialPage', { type: 'Edit', material: material });\r\n    modal.onDidDismiss((data) => {\r\n      this._loadmaterialcats();\r\n    });\r\n    modal.present();\r\n  }\r\n\r\n  filtermaterialcats($event: any): void {\r\n    const value: string = $event.target.value ? $event.target.value.toLowerCase() : '';\r\n    this.filteredmaterial = [];\r\n\r\n    for (let material of this.material) {\r\n      if (material.name.toLowerCase().indexOf(value) !== -1) {\r\n        this.filteredmaterial.push(material);\r\n      }\r\n    }\r\n  }\r\n\r\n  deletematerialcat(material: Material) {\r\n    \r\n      const alert = this.alertCtrl.create({\r\n        title: 'Delete material category',\r\n        message: 'Are you sure you want to delete material category: ' + material.name,\r\n        buttons: [\r\n          {\r\n            text: 'Cancel',\r\n            role: 'cancel'\r\n          },\r\n          {\r\n            text: 'Confirm',\r\n            handler: () => {\r\n              this.db.deletematerial(material)\r\n                .then((success: boolean) => {\r\n                  this._loadmaterialcats();\r\n                  this.tableCheck = false;\r\n                });\r\n            }\r\n          }\r\n        ]\r\n      });\r\n      alert.present();\r\n    \r\n  }\r\n\r\n  activate() {\r\n    this.show = true;\r\n  }\r\n\r\n  /* handleFiles(event) {\r\n    console.log(event);\r\n    this.files = event.target.files;\r\n    console.log(this.files);\r\n\r\n    var reader: FileReader = new FileReader();\r\n    reader.readAsDataURL(this.files[0]);\r\n    console.log(reader);\r\n\r\n    reader.onload = (e) => {\r\n      this.convertFiles = reader.result;\r\n      console.log(this.convertFiles);\r\n      return new Promise((resolve, reject) => {\r\n        var url = this.convertFiles;\r\n        var oReq = new XMLHttpRequest();\r\n        var workbook: any;\r\n        oReq.open(\"GET\", url, true);\r\n        oReq.responseType = \"arraybuffer\";\r\n        oReq.onload = (e) => {\r\n          if (oReq.status >= 200 && oReq.status < 300) {\r\n            var arraybuffer = oReq.response;\r\n            var data = new Uint8Array(arraybuffer);\r\n            var arr = new Array();\r\n            for (var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);\r\n            var bstr = arr.join(\"\");\r\n            workbook = XLSX.read(bstr, { type: \"binary\" });\r\n            var worksheetname = workbook.SheetNames[0];\r\n            var worksheet = workbook.Sheets[worksheetname];\r\n            var json = XLSX.utils.sheet_to_json(worksheet, { raw: true });\r\n\r\n            json.forEach(item => {\r\n              var arrayCheck = ['NAME', 'TAG', 'SIZE', 'SPEC', 'DESIGN CONDITION', 'MATERIAL', 'P&ID', 'DESIGN TEMPERATURE', 'CORROSION ALLOWANCE'];\r\n              for (var i = 0; i < arrayCheck.length; i++) {\r\n                console.log(item[arrayCheck[i]]);\r\n                if (item[arrayCheck[i]] == undefined) {\r\n                  item[arrayCheck[i]] = 'N/A';\r\n                }\r\n              }\r\n              var equipmet = {\r\n                id: Math.round((new Date()).getTime()).toString(),\r\n                rev: '',\r\n                name: item['NAME'],\r\n                tag: item['TAG'],\r\n                size: item['SIZE'],\r\n                designcondition: item['DESIGN CONDITION'],\r\n                designtemperature: item['DESIGN TEMPERATURE'],\r\n                additionalinfo: 'MATERIAL: ' + item['MATERIAL'] + ' P&ID: ' + item['P&ID'] + ' CORROSION ALLOWANCE: ' + item['CORROSION ALLOWANCE'],\r\n                materialparts: []\r\n              }\r\n              this.db.savematerialcat(equipmet).then(res => {\r\n                this._loadmaterialcats();\r\n              });\r\n            })\r\n            resolve('Finished generating JSON');\r\n          } else {\r\n            reject(console.log('XMLHttpRequest failed; error code:' + oReq.statusText));\r\n          }\r\n        }\r\n        oReq.send();\r\n      });\r\n    }\r\n\r\n  } */\r\n\r\n  trackByName = (index, item) => {\r\n    return item.id;\r\n  }\r\n\r\n  checkboxClicked(material, event) {\r\n    if (event._value) {\r\n      material['selected'] = true;\r\n    }\r\n    else {\r\n      material['selected'] = false;\r\n    }\r\n    this.newMaterials = this.material.filter(data => data['selected'] == true)\r\n\r\n    if (this.newMaterials.length > 0) {\r\n      this.tableCheck = true;\r\n      event._value = true;\r\n    }\r\n    else {\r\n      this.tableCheck = false;\r\n    }\r\n\r\n  }\r\n\r\n  deleteSelected() {\r\n    if (this.showButton == true) {\r\n      const alert = this.alertCtrl.create({\r\n        title: 'Delete Material',\r\n        message: 'Are you sure you want to delete Selected Materials ',\r\n        buttons: [\r\n          {\r\n            text: 'Cancel',\r\n            role: 'cancel'\r\n          },\r\n          {\r\n            text: 'Confirm',\r\n            handler: () => {\r\n              this.newMaterials.forEach(material => {\r\n                this.db.deletematerial(material)\r\n                  .then((success: boolean) => {\r\n                    this._loadmaterialcats();\r\n                  });\r\n              })\r\n            }\r\n          }\r\n        ]\r\n      });\r\n      alert.present();\r\n    }\r\n  }\r\n  \r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/material/material.ts"],"sourceRoot":""}